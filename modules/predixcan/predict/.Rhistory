gds.file <- "chrom22.gds"
snpannot.file <- "snp.annot.RDS"
getwd()
setwd("/hpc/users/xrajagv01/myscratch/predictdb/PrediXcan/Software/PrediXcanExample/weights")
db.file <- "new.db"
db
wts.temp <- tbl(db,"weights") %>% collect()
head(wts.temp)
extra.temp <- tbl(db,"extra") %>% collect()
extra.temp <- tbl(db,"extras") %>% collect()
dim(wts.temp)
db.file <- "TW_Cells_EBV-transformed_lymphocytes_0.5.db"
wts.temp <- tbl(db,"weights") %>% collect()
head(wts.temp)
extra.temp <- tbl(db,"extra") %>% collect()
head(extra.temp)
snpannot
wts.temp
wts.temp <- wts.temp[snpannot$rsid]
class(wts.temp)
wts.temp <- data.table(wts.temp)
wts.temp <- wts.temp[snpannot$rsid]
wts.temp <- wts.temp[rsid %in% snpannot$rsid]
wts.temp
length(unique(wts.temp$gene))
genes <- wts.temp$gene
head(genes)
i=1
ensid
dbwts
snpwts
snpwts
psnps
snps.df
outpu1 <- "temp"
outpu1 <- "temp.gds"
output1 <- "temp.gds"
dim(genos)
genos[1:2,1:17]
genos[1:2,1:7]
genos
snpwts
length(snpwts)
dim(genos)
predictedexpr <- genos %>% snpwts
predictedexpr <- genos %*% snpwts
head(predictedexpr)
predictedexpr <- t(predictedexpr)
genos
apply(genos,2,table)
genos[1:2,1:17]
applyr(genos,2,table)
apply(genos,2,table)
apply(genos,2,table)
table(is.na(genos))
ls()
mgds
tempgds
gds.file <- "temp.gds"
dim(genos)
dim(snpwts)
index
gene
ensid
ls()
wts.temp
wts.temp[gene==gene]
wts.temp[gene==gene]
geen
gene
wts.temp[gene==ensid]
dbwts
snpwts
snpwts
index
ensid
gds.file <- "chrom22.gds"
gds.file <- "c22.gds"
i
genes[22]
ensid
index
snpwts
genos
dim(genos)
length(snpwts)
length(index)
output1 <- "temput"
gds.file <- "ch22.gds"
output1
gds.file <- "chr22.gds"
i
genes[179]
ensid
length(genes)
tail(genes)
genes <- unique(genes)
length(genes)
totalexpr[1:2,1:30]
ls()
snpwts
dbwts
snps.df
mgds
ls()
mgds <- "chr22.gds"
mgds.file <- "chr22.gds"
mgds <- snpgdsOpen(mgds.file)
mgds
alleles
head(alleles)
head(alleles)
alleles
db.wt
dbwts
closefn.gds(mgds)
i=1
alleles
head(dbwts)
dbwts
dim(genos)
head(genos)
length(sampleids)
nrow(genos)
length(sampleids)
genos[1:10,1:10]
genos[1:10,1:0]
genos[1:10,1:2]
dim(genos)
dim(genos)
dim(genos)
dim(predictedexpr)
dim(genos)
dim(genos)
dim(genos)
head(alleles)
table(alleles$A2 == snps.df$ef)
table(alleles$A2 == snps.df$)
head(snps.df)
dbwts
table(alleles$A2 == dbwts$eff_allele)
genos[1:2,1:10]
temp <- apply(genos,2,function(x) if())
genos[1,]
2 - genos[1,]
2 - genos[1,] [1:10]
genos[1,] [1:10]
genos[1,] <- 2 - genos[1,]
genos[1:2,1:10]
genes
genes.full <- genes
genes = genes[1:10]
genes
gds.file
gds.file <- "chromosome22.gds"
dim(totalexpr)
totalexpr[,1:10]
snpwts
dbwts
dbwts
dbwts
snps.df
rownames(dbwts)
dbwts["rs715544"]
dbwts["rs715544",]
dbwts["rs715544",,with=FALSE]
dbwts
dbwts
head(dbwts)
head(snps.df)
mgds
temp <- snpannot[snpannot$rsid %*% "rs1"]
temp <- snpannot[snpannot$rsid %*% c("Rs1")]
snpannot
temp <- snpannot[snpannot$rsid %*% c("Rs1"),]
rss = c("rs1")
temp <- snpannot[snpannot$rsid %*% rss]
temp <- snpannot[snpannot$rsid %in% "rs1"]
temp
nrow(temp)
gds.file <- "chrom22.gds"col
ncol(temp)
is.null(temp)
is.null(nrow(temp))
is.null(ncol(temp))
dim(predictedexpr)
matrix(NA,1,2504)
dim(predictedexpr)
totalexpr
snps.df
nrow(snps.df)
temp <- snpannot[snpannot$rsid %in% c("rs715544")]
temp
dim(temp)
class(temp)
temp1 <- as.data.frame(temp)
temp1
dim(temp1)
temp <- snpannot[snpannot$rsid %in% c("rs1")]
temp
temp1 <- as.data.frame(temp)
temp1
dim(temp1)
